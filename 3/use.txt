got c working, speed up of 30%